The following is the procedure I used to succesfully install Ash3d on the computer vsc-ash on 2/3/2012:

We have successfully installed Ash3d on Ubuntu and Red Hat linux systems.  Below are the commands
I used recently to install Ash3d and all the necessary dependent software on an Ubuntu 11 system
(pumice.wr.usgs.gov)

0)  Some valuable utilities that should be on the computer anyway:
        a)  locate      "sudo yum install mlocate"  (on Centos)
                        --used to locate files.  This program seems to come automatically on Ubuntu and Centos 7
        b)  vim         "sudo apt-get install vim"  (on Ubuntu)
                        --for better text editing.  This program seems to come automatically on Centos 7
        c)  tkdiff      "sudo yum install tkcvs"    (on Centos)
                        --useful for comparing files

1)  Install software packages needed for Ash3d: 
	a)  gfortran 	"sudo apt-get install gfortran" (on Ubuntu)
                        "sudo yum install gcc-gfortran" (on centos)
                        --needed unless you have a fortran compiler that you'd rather use.  In that
                          case you will need to modify some lines in the makefile to point to
                          your favorite fortran compiler.
	b)  java jdk 	"sudo apt-get install default-jdk" (on Ubuntu)
                        "sudo yum install java-openjdk"  (on redhat, centos etc.)
                        --needed to convert wind files from grib2 to netcdf after downloading them
                          from the unidata repository
	c)  zip      	"sudo apt-get install zip"  (on Ubuntu)
                        "sudo yum install zip"      (on centos)
                        --needed to zip up kml files to kmz files.
                          Ash3d creates kml files that can be opened in Google Earth.  The kml
                          files can be pretty big (tens of megabytes), but using zip they can
                          be converted to kmz files, which are about 95-99% smaller.
	d) imagemagick 	"sudo apt-get install imagemagick" (on Ubuntu)
                        "sudo yum install ImageMagick"     (on centos)
                        --needed only if you intend to use the shell script GFSVolc_to_gif_ac.sh
                          to create animated gif files of cloud movement from the model output.
	e) subversion	"sudo apt-get install subversion" (on Ubuntu & other Debian systems)
                        "sudo yum install subversion"            (on redhat, centos etc.)
                        --needed to administer the svn repository
	f) lapack	"sudo apt-get install liblapack-dev" (on Ubuntu)
                        "sudo yum install lapack-devel"      (on centos)
                        --needed for program numerical calculations.
	g) epstopdf	"sudo apt-get install texlive-font-utils"  (on Ubuntu)
                        "sudo yum install texlive-epstopdf         (on centos)
                        --needed only if you intend to use the shell script GFSVolc_to_gif_ac.sh
                          or GFSVolc_to-gif_dp.sh to create animated gif files of cloud movement 
                         from the model output.
        h) bc               "sudo apt-get install bc"  (on Ubuntu)
                            "sudo yum install bc"      (on centos)
                            --bc does arithmetic at the command line and is used in some shell scripts.
        i) gifsicle         "sudo apt-get install gifsicle"  (on Ubuntu)
                             The following commands worked in CentOS:
                               mkdir ~/gifsicle; cd ~/gifsicle
                               wget https://www.lcdf.org/gifsicle/gifsicle-1.88.tar.gz --no-check-certificate
                               gunzip gifsicle-1.88.tar.gz
                               tar -xvf gifsicle-1.88.tar
                               cd gifsicle-1.88
                               configure; make; sudo make install
                            --combines static gifs into animated gifs.  Is used to create the cloud animation gifs.
        j) unix2dos         "sudo apt-get install unix2dos"  (on Ubuntu)
                            "sudo yum install unix2dos"      (on centos)
                            --changes line endings on output text files so they can be viewed on Windows.
        k) gnuplot          "sudo apt-get install gnuplot    (on Ubuntu)
                            "sudo yum install gnuplot        (on centos)
                            --used to make plots of ash accumulation vs. time for AshArrivalTimes_airports.kmz
        l) ntfs-3g          "sudo yum --enablerepo=extras install epel-release"
                            "sudo yum install ntfs-3g"   (only needed on Centos)
                            --allows Centos to read ntfs-formatted drives
        m) libgrib          "sudo apt-get install libgrip-api*"       (on Ubuntu)
                            "sudo yum     install libgrib* grib_api*" (on Centos)
                             
                            --needed by the core code to directly read grid files
****************THE FOLLOWING MESSED EVERYTHING UP ON CENTOS WHEN INSTALLING ON PHOBOS******************
2) Install the python libraries  "sudo apt-get install python-gdal" (on Ubuntu)
                             "sudo apt-get install libproj-dev" (on Ubuntu)
                              on Centos, type the following: (didn't work 1/5/2017 on phobos)
                  wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
                                  sudo rpm -Uvh epel-release-6-8.noarch.rpm
                                  sudo yum update
                                  sudo yum install gdal gdal-devel
                           --these are needed to create shapefiles
*******************************************************************************************************
                            
3)  Install netcdf.  
        Ash3d reads wind files written in netcdf format and (optionally) writes some 
        output to a netcdf file. On pumice I was only able to get netcdf3.6.3 to compile with Ash3d.  
	netcdf-4 was not installing.  To install netcdf-3.6.3 I did the following:
        a) Get programs that are needed for netcdf
                   sudo apt-get install -y m4  (on ubuntu)
                   sudo yum     install -y m4  (on centos)
                 --needed for the netcdf build
                   sudo apt-get install -y git (on ubuntu)
                   sudo yum     install -y git (on centos)
                 --needed to download netcdf-fortran
      On Ubuntu:
        b) Get and install the c version, using the newly (v. 4.4) feature that allows fortran
                   mkdir ~/netcdf
                   cd    ~/netcdf
                   wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-4.4.1.1.tar.gz
                   gunzip netcdf-4.4.1.1.tar.gz
                   tar -xvf netcdf-4.4.1.1.tar
                   cd netcdf-4.4.1.1
                   ./configure --prefix=/usr --disable-netcdf4 --enable-remote-fortran-bootstrap
                   make
                   make check
                   sudo make install
               --the library and include directories should be in /usr
                 Verify that they are there by typing:
                   ls /usr/lib/*netcdf*
                   ls /usr/include/*netcdf*
        c) Build the Fortran libraries
                   make build-netcdf-fortran
                     (I got a couple of errors in the check, but it still compiled Ash3d okay
                   sudo make install-netcdf-fortran
    On CentOS: 
           Theoretically, one can get the whole thing with the command:
               sudo yum install -y netcdf-devel
           However when trying to compile Ash3d, I got an error message because the module file
           netcdf.mod was created with a different version of gnu fortran from the one I had.
           So, I had to download the source code and compile.
        b) Get and install the c version:
                   mkdir ~/netcdf
                   cd    ~/netcdf
                   wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-4.4.1.1.tar.gz
                   gunzip netcdf-4.4.1.1.tar.gz
                   tar -xvf netcdf-4.4.1.1.tar
                   cd netcdf-4.4.1.1
                   ./configure --prefix=/usr --disable-netcdf4 
                      (the option "--enable-remote-fortran-bootstrap" did not work when I
                       tried it on 1/5/2015 building phobos)
                   make
                   make check
                   sudo make install
               --the library and include directories should be in /usr
                 Verify that they are there by typing:
                   ls /usr/lib/*netcdf*
                   ls /usr/include/*netcdf*
        c) Get and install the Fortran version:
                   mkdir ~/netcdf/fortran; cd ~/netcdf/fortran
                   wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-fortran-4.4.4.tar.gz
                   gunzip netcdf-fortran-4.4.4.tar.gz
                   tar -xvf netcdf-fortran-4.4.4.tar
                   cd netcdf-fortran-4.4.4
                   NCDIR=/usr
                   CC=/usr/bin/cc
                   FC=/usr/bin/gfortran
                   export LD_LIBRARY_PATH=${NCDIR}/lib:${LD_LIBRARY_PATH}
                   NFDIR=/usr
                   CPPFLAGS=-I${NCDIR}/include LDFLAGS=-L${NCDIR}/lib
                   ./configure --prefix=${NFDIR}
                   make check
                   sudo make install

4)  install netcdf-java
        Netcdf-java is used to convert wind files downloaded from the unidata repository
        from grib2 to netcdf format, which can then be read by Ash3d.
	a)  from phobos. ftp the file /home/lgmastin/ncj/netcdfAll-4.2.jar
		and place it in the directory ~/ncj
		(I tried using the current version from unidata, netAll-4.2.jar,
		but it converted ncml files to netcdf differently from
		netcdfAll-4.1.jar, making them unreadable to Ash3d.).
		note: if you place it in a directory other than ~/ncj,
		you will need to modify the command lines in  the autorun script
		that begin with "java -Xmx2048m -classpath ~/ncj"
5)  install Ash3d.  Ash3d comes in four components: volcano-ash3d-metreader,
         volcano-ash3d-projection, and volcano-ash3d-hourssince.  Each of these must
	 be installed and compiled separately.  Libraries from these are created in /opt/USGS/lib
	 which you will have to create if it doesn't already exist.  If you don't have 
	 administrative privileges and can't create directories in /opt, you will have to
	 create a local directory that can hold the libraries, and modify the makefiles
	 to the metreader, projection, and hourssince components so that the "INSTALLDIR="
	 line points to the new directory, not to /opt/USGS.  You must also make this modification
	 in the makefile to Ash3d.
                mkdir ~/Ash3d
		mkdir ~/Ash3d/git
		cd ~/Ash3d/git"
		git clone https://github.com/hschwaiger-usgss/volcano-ash3d-metreader
		git clone https://github.com/hschwaiger-usgss/volcano-ash3d-projection
		git clone https://github.com/hschwaiger-usgss/volcano-ash3d-hourssince
		cd ~/Ash3d/git/volcano-ash3d-metreader
		make
		sudo make install                    --> copies the library file to /opt/USGS/lib
		cd ~/Ash3d/git/volcano-ash3d-projection
		make
		sudo make install                    --> copies the library file to /opt/USGS/lib
		cd ~/Ash3d/git/volcano-ash3d-hourssince
		make
		sudo make install                    --> copies the library file to /opt/USGS/lib
	--The following assumes you have a zipped copy of the Ash3d source code, located at ${SOURCELOC}
		mv ${SOURCELOC}/Ash3d.zip ~/Ash3d/git
		cd ~/Ash3d/git
		unzip Ash3d.zip
                make
                sudo make install                    --> copies the executable to /opt/USGS/Ash3d/bin
6)  compile makencml fortran codes:
        ncml is a language developed by Unidata (http://www.unidata.ucar.edu) to create
        "wrappers" of grib2 or netcdf files.  I create an ncml wrapper of the downloaded
        wind files that allows only a subset of data in the grib2 files to be converted
        into netcdf format.  Thus the netcdf files are smaller than they would otherwise
        be.  To create the ncml wrapper I use a fortran code, which must be compiled
        separately from the other ash3d code.
           mkdir ~/Ash3d/autoruns
	   cd ~/Ash3d/autoruns
	    gfortran -o makegfsncml makegfsncml.f90
	c) If you'll be downloading wind files other than gfs, type:
		gfortran -o makeNAMAK11kmncml makeNAMAK11kmncml.f90
		gfortran -o makeNAMCONUS40kmncml makeNAMCONUS40kmncml.f90
7)  install GMT
        GMT (Generic Mapping Tools) is used to create maps of model output.
        The output maps are created using the shell scripts GFSVolc_to_gif_ac.sh
        and GFSVolc_to_gif_dp.sh.  Model output can also be viewed in Google
        Earth using the kml output files, hence GMT is not essential.
        Do one of the following:
           a) "sudo apt-get install gmt" (Ubuntu)
           b) "sudo yum install gmt gshhg-gmt-nc4-high.noarch"     (Centos)

8)  (on phobos, perhaps other computers) mount a second drive:
      --First, find the location of the second drive to /data3.  Currently, the drive is /dev/sdb1:
           sudo mkdir /data3
           sudo mount -t ext3 /dev/sdb1 /data3/

7)  set crontab
	a) in home directory, type "env EDITOR=nano crontab -e" (unless you prefer another editor)
	b) Add autorun scripts so the crontab entries look like the lines below.
                --note: 1)  you will have to change {working_directory} to the path of the
                            that contains Ash3d, and {other directory} to the name of another
                            directory where you would like log files to go.
                        2)  You will have to change directory names in some login scripts in order
                            for the download to be successful. Notably, add the following lines to
                               export ASH3DROOT={directory location of ash3drepository/branches/vsc-ash}
                               export GFSDATAHOME={directory location of gfs wind files}
**********************************************************************************************************************
# m h  dom mon dow   command
01 09   *   *   *  /bin/sh {working_directory}/src/autorun_scripts/autorun_gfs0.5deg_12 > {other_directory}/gfs12_log  2>&1
01 21   *   *   *  /bin/sh {working_directory}/src/autorun_scripts/autorun_gfs0.5deg_00 > {other_directory}/gfs00_log  2>&1
01 01   *   *   *  /bin/sh {working_directory}/src/autorun_scripts/NCEP_50year_Reanalysis.sh > {other_directory}/NCEP_50yr_log 2>&1
***********************************************************************************************************************
8)  make destination windfile directory
	a) to emulate pumice:
		cd /usr/local
		sudo mkdir data
		cd data
		sudo mkdir WindFiles
		sudo chmod a+w WindFiles
		cd WindFiles
		sudo mkdir gfs
		sudo chmod a+w gfs
		cd gfs
		sudo mkdir latest
		sudo chmod a+w latest
9) try out windfile download:
	cd {working_directory}/src/autorun_scripts
	./autorun_gfs0.5deg_12	
10)  make a test volcano directory (mine is called ~/volcanoes)
	mkdir ~/volcanoes
	cd volcanoes
	mkdir Eyja
	cd Eyja
	mkdir GUI
	cd GUI
	sftp phobos.wr.usgs.gov
		cd volcanoes/Eyja/GUI
		get ash3d_input*
		get runAsh3d.sh
		exit
	ln -s /usr/local/data/WindFiles/gfs/latest Wind_nc
	ln -s ~/Ash3d/working_directory/ash3drepository/input_files/GlobalAirports.txt .
